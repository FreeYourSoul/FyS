<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FreeYourSoul Online: fys::arena::ArenaServerService Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="choco.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FreeYourSoul Online
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">MMORPG</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>fys</b></li><li class="navelem"><b>arena</b></li><li class="navelem"><a class="el" href="classfys_1_1arena_1_1_arena_server_service.html">ArenaServerService</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classfys_1_1arena_1_1_arena_server_service-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">fys::arena::ArenaServerService Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class managing an Arena Server. <br  />
 An arena server is a server handling multiple arena fighting pit instance at once. In order to properly works, it need to work with an ArenaDispatcher, which is a proxy for the WorldServer to communicate with Arena.  
 <a href="classfys_1_1arena_1_1_arena_server_service.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_arena_server_service_8hh_source.html">ArenaServerService.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afab9e43f2294fd99b3019bb42d94f83c"><td class="memItemLeft" align="right" valign="top"><a id="afab9e43f2294fd99b3019bb42d94f83c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ArenaServerService</b> (const <a class="el" href="classfys_1_1arena_1_1_arena_server_context.html">ArenaServerContext</a> &amp;ctx)</td></tr>
<tr class="separator:afab9e43f2294fd99b3019bb42d94f83c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae335fe525fd28119a792fa4b49093d85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfys_1_1arena_1_1_arena_server_service.html#ae335fe525fd28119a792fa4b49093d85">runServerLoop</a> () noexcept</td></tr>
<tr class="memdesc:ae335fe525fd28119a792fa4b49093d85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run infinite loop that poll on the connections of the dispatcher, then of the players.  <a href="classfys_1_1arena_1_1_arena_server_service.html#ae335fe525fd28119a792fa4b49093d85">More...</a><br /></td></tr>
<tr class="separator:ae335fe525fd28119a792fa4b49093d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class managing an Arena Server. <br  />
 An arena server is a server handling multiple arena fighting pit instance at once. In order to properly works, it need to work with an ArenaDispatcher, which is a proxy for the WorldServer to communicate with Arena. </p>
<p>fys::arena::ArenaServerService::createNewFightingPit In case of a new encounter for a player, the following workflow apply:</p><ul>
<li>Player is moving / doing an action on the WorldMap (managed by a WorldServer) that is triggering a new encounter. [publisher socket send notification] <br  />
<br  />
</li>
<li>WorldServer send a message to a ArenaDispatcher containing configuration data to generate a fighting pit and authentication information, those are the following:<br  />
<ul>
<li>a generated token (used as authentication key)<br  />
</li>
<li>the difficulty of the fight (configuration of the player)<br  />
</li>
<li>the id of encounter; if equal to 0, it is a random encounter. scripted id otherwise.<br  />
</li>
</ul>
</li>
<li>The <a class="el" href="classfys_1_1_dispatcher.html">Dispatcher</a> forward the message to an ArenaServer that is going to register the incoming player that will initiate the creation of the fighting pit. <br  />
<br  />
</li>
<li>The Arena server reply to the dispatcher (that will reply to the WorldServer), the message will return to the player, message containing the ip (connection string) of the ArenaServer that will create the fighting pit. <br  />
<br  />
</li>
<li>The Player can then directly connect to the ArenaServer using the token to validate the authentication, The Arena service validate the connection, and use the data (difficulty ect..) in order to generate the fighting pit (with an id unique). When the fight is setup, the initial handshake with the client contains the id of the fighting pit in order to enable other player to join. <br  />
</li>
</ul>
<p>@joinFightingPit Another player than the creator can join an existing arena by specifying its fighting pit id to the WorldServer, which will check if the position of the joining player is close enough of the creator of the fighting pit. The ArenaServer is then just going to check the existence of the id and will add the player into the fight. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ae335fe525fd28119a792fa4b49093d85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae335fe525fd28119a792fa4b49093d85">&#9670;&nbsp;</a></span>runServerLoop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void fys::arena::ArenaServerService::runServerLoop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run infinite loop that poll on the connections of the dispatcher, then of the players. </p>
<dl class="section note"><dt>Note</dt><dd>This method contains the code of the deserialization of flatbuffer message (ioc with lambda) and then check if the incoming message is coming from an authorized user. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/FyS/Project/FyS/services/arena/include/<a class="el" href="_arena_server_service_8hh_source.html">ArenaServerService.hh</a></li>
<li>/home/FyS/Project/FyS/services/arena/src/ArenaServerService.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
